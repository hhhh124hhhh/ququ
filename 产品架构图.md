# 蛐蛐 (QuQu) 产品架构分析

## 1. 产品定位与核心价值主张

### 1.1 产品定位
**蛐蛐 (QuQu)** 是一个专为中文用户设计的开源免费桌面端语音转文字应用，定位为 Wispr Flow 的直接替代方案。

### 1.2 核心价值主张
- **零成本**: 完全开源免费，无订阅费用
- **隐私优先**: 数据本地处理，不上传云端
- **中文优化**: 专为中文语言和互联网文化优化
- **国产AI支持**: 优先适配国内AI模型
- **开发者友好**: 支持编程术语和代码格式化

### 1.3 目标用户群体

#### 主要目标用户
1. **中文内容创作者** (30%)
   - 博客作者、自媒体运营者
   - 需要大量文字输入的编辑和记者
   - 偏好本地处理的隐私敏感用户

2. **开发者和技术人员** (25%)
   - 需要编写技术文档的程序员
   - 代码注释和API文档编写
   - 技术博客创作者

3. **商务办公人士** (20%)
   - 需要撰写邮件和报告的白领
   - 会议记录和纪要整理
   - 对成本敏感的企业用户

4. **学生和研究人员** (15%)
   - 论文写作和文献整理
   - 课堂笔记和复习资料
   - 预算有限的学术用户

5. **技术爱好者** (10%)
   - 开源软件支持者
   - 隐私保护倡导者
   - 喜欢折腾和定制的极客用户

## 2. 详细产品架构图

### 2.1 整体系统架构

```mermaid
graph TB
    subgraph "用户界面层"
        A[主界面 - App.jsx]
        B[设置页面 - settings.jsx]
        C[历史记录 - history.jsx]
        D[系统托盘]
    end

    subgraph "应用逻辑层"
        E[Electron主进程 - main.js]
        F[窗口管理器]
        G[热键管理器]
        H[剪贴板管理器]
        I[数据库管理器]
    end

    subgraph "业务逻辑层"
        J[FunASR管理器]
        K[环境管理器]
        L[IPC处理器]
        M[权限管理器]
    end

    subgraph "AI处理层"
        N[FunASR服务 - Python]
        O[本地ASR模型]
        P[外部AI模型API]
    end

    subgraph "数据存储层"
        Q[SQLite数据库]
        R[本地模型文件]
        S[配置文件]
    end

    A --> E
    B --> E
    C --> E
    D --> E

    E --> F
    E --> G
    E --> H
    E --> I

    E --> J
    E --> K
    E --> L
    E --> M

    J --> N
    N --> O
    L --> P

    I --> Q
    J --> R
    K --> S
```

### 2.2 核心功能模块架构

```mermaid
graph LR
    subgraph "语音输入模块"
        A1[全局快捷键F2]
        A2[麦克风权限管理]
        A3[音频录制]
        A4[实时音频流处理]
    end

    subgraph "语音识别模块"
        B1[FunASR服务进程]
        B2[Paraformer-large模型]
        B3[FSMN-VAD模型]
        B4[CT-Transformer标点模型]
    end

    subgraph "文本处理模块"
        C1[原始转录文本]
        C2[AI文本优化]
        C3[格式化和清理]
        C4[编程术语识别]
    end

    subgraph "输出模块"
        D1[剪贴板自动粘贴]
        D2[历史记录存储]
        D3[多格式导出]
    end

    A1 --> A2
    A2 --> A3
    A3 --> A4
    A4 --> B1

    B1 --> B2
    B1 --> B3
    B1 --> B4

    B2 --> C1
    B3 --> C1
    B4 --> C1

    C1 --> C2
    C2 --> C3
    C3 --> C4

    C4 --> D1
    C4 --> D2
    C4 --> D3
```

### 2.3 数据流架构

```mermaid
sequenceDiagram
    participant U as 用户
    participant UI as 前端界面
    participant MP as 主进程
    participant FS as FunASR服务
    participant AI as 外部AI
    participant DB as 数据库

    U->>UI: 按下F2快捷键
    UI->>MP: IPC: start-recording
    MP->>FS: 启动FunASR进程
    MP->>UI: 返回录音状态

    loop 音频处理
        UI->>MP: 音频数据
        MP->>FS: 发送音频流
        FS->>MP: 转录文本
        MP->>UI: 实时转录结果
        UI->>U: 显示转录文本
    end

    U->>UI: 停止录音
    UI->>MP: IPC: stop-recording

    alt 启用AI优化
        MP->>AI: 发送原始文本
        AI->>MP: 返回优化文本
    end

    MP->>DB: 保存转录记录
    MP->>UI: 最终文本
    UI->>U: 自动粘贴到光标位置
```

## 3. 技术栈架构分析

### 3.1 前端技术栈
```mermaid
graph TB
    subgraph "前端框架"
        A[React 19]
        B[TypeScript]
        C[Tailwind CSS]
    end

    subgraph "UI组件库"
        D[shadcn/ui]
        E[Radix UI]
        F[Lucide React]
    end

    subgraph "构建工具"
        G[Vite 6]
        H[ESLint]
        I[PostCSS]
    end

    A --> D
    B --> A
    C --> A
    D --> E
    E --> F
    G --> A
    G --> I
    H --> A
```

### 3.2 后端技术栈
```mermaid
graph TB
    subgraph "桌面框架"
        A[Electron 36.5.0]
        B[Node.js 18+]
    end

    subgraph "Python服务"
        C[FunASR框架]
        D[PyTorch]
        E[ModelScope]
    end

    subgraph "数据存储"
        F[better-sqlite3]
        G[本地文件系统]
    end

    subgraph "AI集成"
        H[OpenAI API]
        I[通义千问]
        J[Kimi]
        K[智谱AI]
    end

    A --> B
    A --> F
    B --> C
    C --> D
    C --> E
    F --> G

    A --> H
    H --> I
    H --> J
    H --> K
```

### 3.3 环境管理架构
```mermaid
graph TB
    subgraph "Python环境管理"
        A[uv环境管理]
        B[系统Python + venv]
        C[嵌入式Python环境]
    end

    subgraph "模型管理"
        D[自动模型下载]
        E[模型缓存机制]
        F[版本控制]
    end

    subgraph "依赖管理"
        G[pnpm]
        H[Node.js依赖]
        I[Python依赖]
    end

    A --> D
    B --> D
    C --> D
    D --> E
    E --> F

    G --> H
    G --> I
```

## 4. 核心功能模块详细设计

### 4.1 语音识别引擎
- **模型选择**: 阿里巴巴 FunASR Paraformer-large
- **支持语言**: 专门优化的中文识别
- **特色功能**:
  - 中文互联网热词识别
  - 方言口音适应性
  - 实时流式识别
  - 低延迟处理

### 4.2 AI文本优化引擎
- **支持模型**: OpenAI API兼容的所有模型
- **优先适配**: 通义千问、Kimi、智谱AI等国产模型
- **优化能力**:
  - 口语化表达转换
  - 语法错误修正
  - 标点符号自动添加
  - 编程术语格式化

### 4.3 隐私保护机制
- **本地处理**: 所有语音和文本数据本地处理
- **零数据上传**: 不向任何第三方服务器传输数据
- **配置加密**: 敏感配置信息本地加密存储
- **用户控制**: 完全的数据删除和导出权限

## 5. 竞争优势分析

### 5.1 vs Wispr Flow 对比
| 维度 | 蛐蛐 (QuQu) | Wispr Flow |
|------|-------------|------------|
| **价格模式** | 完全免费 | $12/月订阅 |
| **隐私保护** | 本地处理 | 云端处理 |
| **中文支持** | 深度优化 | 通用支持 |
| **AI模型** | 国外+国产模型 | 仅国外模型 |
| **开源程度** | 完全开源 | 闭源商业软件 |
| **定制性** | 高度可定制 | 有限定制 |
| **部署方式** | 本地部署 | SaaS服务 |

### 5.2 核心竞争优势
1. **成本优势**: 零使用成本，无订阅费用
2. **隐私优势**: 完全本地处理，数据不上传
3. **本土化优势**: 针对中文深度优化
4. **生态优势**: 支持国产AI模型生态系统
5. **技术优势**: 开源可定制，社区驱动发展
6. **合规优势**: 符合国内数据保护法规要求